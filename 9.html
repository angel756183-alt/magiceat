<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆé¤é­”æ³•å°å°è§£é™¤</title>
    
    <!-- iOS ä¸»ç•«é¢åœ–ç¤º -->
    <link rel="apple-touch-icon" id="appleIcon">
    
    <!-- iOS å•Ÿå‹•ç•«é¢èƒŒæ™¯è‰² -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="é­”æ³•é¤é»">
    
    <!-- Android Chrome -->
    <meta name="theme-color" content="#667eea">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            background: white;
            border-radius: 25px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 500px;
            width: 100%;
            padding: 40px 30px;
            text-align: center;
            position: relative;
            z-index: 1;
        }
        
        .header {
            margin-bottom: 40px;
        }
        
        .header h1 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p {
            color: #666;
            font-size: 1em;
        }
        
        .seal-icon {
            font-size: 5em;
            margin: 30px 0;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-20px);
            }
        }
        
        .recommend-btn {
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 1.3em;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(255, 216, 155, 0.4);
            margin: 20px 0;
            width: 100%;
        }
        
        .recommend-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(255, 216, 155, 0.6);
        }
        
        .recommend-btn:active {
            transform: translateY(-2px);
        }
        
        .result-container {
            margin-top: 40px;
            display: none;
            animation: slideIn 0.5s ease-out;
        }
        
        .result-container.show {
            display: block;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .result-card {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .result-card h3 {
            color: #764ba2;
            font-size: 1.2em;
            margin-bottom: 15px;
        }
        
        .result-card .item-name {
            font-size: 1.8em;
            font-weight: bold;
            color: #333;
            margin: 10px 0;
        }
        
        .result-card .item-price {
            font-size: 1.5em;
            color: #667eea;
            font-weight: bold;
        }
        
        .result-card .item-detail {
            color: #555;
            font-size: 1.1em;
            margin-top: 10px;
        }
        
        .total-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 20px;
            margin-top: 20px;
        }
        
        .total-card h3 {
            font-size: 1.1em;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .total-card .total-price {
            font-size: 2.5em;
            font-weight: bold;
        }
        
        .action-buttons {
            display: grid;
            gap: 15px;
            margin-top: 30px;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 15px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.5);
        }
        
        .btn-secondary {
            background: white;
            color: #667eea;
            border: 3px solid #667eea;
        }
        
        .btn-secondary:hover {
            background: #f8f9fa;
            transform: translateY(-3px);
        }
        
        .sparkles {
            position: fixed;
            pointer-events: none;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
        }
        
        .sparkle {
            position: absolute;
            width: 5px;
            height: 5px;
            background: white;
            border-radius: 50%;
            opacity: 0;
            animation: sparkle 2s infinite;
        }
        
        @keyframes sparkle {
            0%, 100% {
                opacity: 0;
                transform: scale(0);
            }
            50% {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .update-notice {
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
            color: white;
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
            display: none;
            animation: pulse 2s infinite;
        }
        
        .update-notice.show {
            display: block;
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.02);
            }
        }
        
        .footer {
            margin-top: 40px;
            color: #999;
            font-size: 0.9em;
        }
        
        .area-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }
        
        .area-btn {
            flex: 1;
            padding: 15px 20px;
            border: 3px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 15px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .area-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .area-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: transparent;
        }
        
        .manage-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1em;
            font-weight: bold;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }
        
        .manage-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }
        
        .modal.show {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding-top: 50px;
        }
        
        .modal-content {
            background: white;
            border-radius: 25px;
            padding: 30px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .modal-header h2 {
            color: #667eea;
            font-size: 1.5em;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 2em;
            color: #999;
            cursor: pointer;
            line-height: 1;
            padding: 0;
            width: 40px;
            height: 40px;
        }
        
        .close-btn:hover {
            color: #ff6b6b;
        }
        
        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .tab-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .tab-btn.active {
            background: #667eea;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: bold;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .add-item-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px;
            width: 100%;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .add-item-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .store-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .store-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 10px;
        }
        
        .store-info {
            flex: 1;
        }
        
        .store-name {
            font-weight: bold;
            color: #333;
            font-size: 1.1em;
        }
        
        .store-price {
            color: #667eea;
            font-weight: bold;
            margin-top: 5px;
        }
        
        .delete-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .delete-btn:hover {
            background: #ff5252;
            transform: scale(1.05);
        }
        
        .search-links {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .search-links h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .search-link {
            display: inline-block;
            background: white;
            color: #667eea;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 8px;
            margin: 5px;
            border: 2px solid #667eea;
            transition: all 0.3s;
        }
        
        .search-link:hover {
            background: #667eea;
            color: white;
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 30px 20px;
            }
            
            .header h1 {
                font-size: 1.5em;
            }
            
            .seal-icon {
                font-size: 4em;
            }
            
            .recommend-btn {
                font-size: 1.1em;
                padding: 18px 35px;
            }
        }
    </style>
</head>
<body>
    <div class="sparkles" id="sparkles"></div>

    <div class="container">
        <div class="update-notice" id="updateNotice">
            <strong>ğŸ”” é­”æ³•å¸«æé†’</strong><br>
            ä»Šå¤©æ˜¯æ¯æœˆæ›´æ–°æ—¥ï¼è«‹è¨˜å¾—æª¢æŸ¥æ˜¯å¦æœ‰æ–°é­”æ³•å ‚éœ€è¦åŠ å…¥åå–® âœ¨
        </div>
        
        <div class="header">
            <h1>ğŸ”® é¤é»å³å°‡å°å°è§£é™¤ ğŸ”®</h1>
            <p>ä¸çŸ¥é“åƒä»€éº¼ï¼Ÿè®“é­”æ³•å¹«ä½ æ±ºå®šï¼</p>
        </div>
        
        <div class="area-selector">
            <button class="area-btn active" id="localBtn" onclick="setArea('local')">
                ğŸ  å–„åŒ–æ–°å¸‚å€æ–½å±•é­”æ³•
            </button>
            <button class="area-btn" id="otherBtn" onclick="setArea('other')">
                ğŸŒ ç•°åœ°å†’éšªå»
            </button>
        </div>
        
        <div class="seal-icon">ğŸ²</div>
        
        <button class="recommend-btn" onclick="unlockSeal()">
            âœ¨ æ–½å±•é­”æ³• âœ¨
        </button>
        
        <div class="result-container" id="resultContainer">
            <div class="result-card">
                <h3>ğŸ± é¤é»é­”æ³•é¡¯ç¾</h3>
                <div class="item-name" id="lunchName"></div>
                <div class="item-price" id="lunchPrice"></div>
            </div>
            
            <div class="result-card">
                <h3>ğŸ¥¤ é£²æ–™é­”æ³•é¡¯ç¾</h3>
                <div class="item-name" id="drinkName"></div>
                <div class="item-price" id="drinkPrice"></div>
            </div>
            
            <div class="total-card">
                <h3>ğŸ’° é­”æ³•ç¸½èŠ±è²»</h3>
                <div class="total-price" id="totalPrice"></div>
            </div>
        </div>
        
        <button class="manage-btn" onclick="openManageModal()">
            âš™ï¸ ç®¡ç†é­”æ³•å ‚åå–®
        </button>
        
        <div class="footer">
            <p>ğŸŒ™ æœˆäº®å¾®ç¬‘æ™‚ï¼Œé­”æ³•ä¸–ç•Œå³å°‡é–‹å•Ÿ âœ¨</p>
        </div>
    </div>
    
    <!-- ç®¡ç†åº—å®¶ Modal -->
    <div class="modal" id="manageModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ”® ç®¡ç†é­”æ³•å ‚åå–®</h2>
                <button class="close-btn" onclick="closeManageModal()">Ã—</button>
            </div>
            
            <div class="tab-buttons">
                <button class="tab-btn active" onclick="switchTab('add')">â• æ–°å¢é­”æ³•å ‚</button>
                <button class="tab-btn" onclick="switchTab('list')">ğŸ“‹ é­”æ³•å ‚æ‰‹æœ­</button>
            </div>
            
            <!-- æ–°å¢åº—å®¶ Tab -->
            <div class="tab-content active" id="addTab">
                <div class="search-links">
                    <h4>ğŸ” å°‹æ‰¾æ–°é­”æ³•å ‚</h4>
                    <a href="https://www.google.com/maps/search/é¤å»³+æ–°å¸‚å€+å°å—" target="_blank" class="search-link">Google Maps æœå°‹</a>
                    <a href="https://www.google.com/maps/search/é£²æ–™åº—+æ–°å¸‚å€+å°å—" target="_blank" class="search-link">é£²æ–™åº—æœå°‹</a>
                </div>
                
                <div class="form-group">
                    <label>é¡å‹</label>
                    <select id="itemType" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1em;">
                        <option value="lunch">ğŸ± é¤é»é­”æ³•å ‚</option>
                        <option value="drink">ğŸ¥¤ é£²æ–™é­”æ³•å ‚</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>é­”æ³•å ‚åç¨±</label>
                    <input type="text" id="storeName" placeholder="ä¾‹ï¼šä¸¹ä¸¹æ¼¢å ¡">
                </div>
                
                <div class="form-group">
                    <label>å¹³å‡åƒ¹æ ¼ï¼ˆå…ƒï¼‰</label>
                    <input type="number" id="storePrice" placeholder="ä¾‹ï¼š85">
                </div>
                
                <button class="add-item-btn" onclick="addStore()">
                    âœ¨ åŠ å…¥é­”æ³•å ‚åå–®
                </button>
            </div>
            
            <!-- æŸ¥çœ‹åå–® Tab -->
            <div class="tab-content" id="listTab">
                <h3 style="color: #667eea; margin-bottom: 15px;">ğŸ± é¤é»é­”æ³•å ‚ (<span id="lunchCount">0</span>)</h3>
                <div class="store-list" id="lunchList"></div>
                
                <h3 style="color: #667eea; margin: 25px 0 15px;">ğŸ¥¤ é£²æ–™é­”æ³•å ‚ (<span id="drinkCount">0</span>)</h3>
                <div class="store-list" id="drinkList"></div>
            </div>
        </div>
    </div>

    <script>
        const menuData = {
            local: {
                lunch: [
                    {name: 'å¥½å£å‘³ç²¥', price: 80},
                    {name: 'ç²¥å…¨', price: 75},
                    {name: 'éºµå…’è¦‹', price: 85},
                    {name: 'å…«æ–¹é›²é›†', price: 70},
                    {name: 'å¿…å‹å®¢', price: 150},
                    {name: 'éº¥ç•¶å‹', price: 120},
                    {name: 'è‚¯å¾·åŸº', price: 130},
                    {name: 'æ¢ç¤¾æ¼¢ä¾¿ç•¶', price: 85},
                    {name: 'æ¸¯å£åœŸé­ é­šç¾¹', price: 90},
                    {name: 'ä¸¹ä¸¹æ¼¢å ¡', price: 85},
                    {name: 'ç‰ç¦¾ç”°è¶Šå—æ–™ç†', price: 100},
                    {name: 'å…ƒçˆµå‘³é»ƒç‡œé›', price: 95},
                    {name: 'æ–°å¸‚æˆåŠŸç‰›æ’', price: 150},
                    {name: 'å°å¹³ æ­£å®—ç«é›è‚‰é£¯', price: 70},
                    {name: 'è—é‹ç‰©', price: 200},
                    {name: 'ä¹é¼æ—è±', price: 120},
                    {name: 'å¤§åŸ”éµæ¿ç‡’', price: 150},
                    {name: 'æ¼¢å ¡ç‹', price: 120},
                    {name: 'é”ç¾æ¨‚', price: 180},
                    {name: 'é˜¿ç å§¨æ»·è‚‰é£¯', price: 60},
                    {name: 'å…«æ–¹ç·£', price: 80},
                    {name: 'è€æ³‰åŸé»ƒç‡œé›ç±³é£¯ï¼ˆå°å—æ–°å¸‚åº—ï¼‰', price: 95},
                    {name: 'çš‡è–é£Ÿå ‚', price: 85},
                    {name: 'éº»å°äºŒ', price: 90},
                    {name: 'æ™¨é–“å»šæˆ¿', price: 100},
                    {name: 'æ‹‰äºæ¼¢å ¡', price: 75},
                    {name: 'ç•ªèŒ„æ‘', price: 85},
                    {name: 'å¼˜çˆºæ¼¢å ¡', price: 70},
                    {name: 'ç”²å°šé£½', price: 80},
                    {name: 'æ—¥+æ—©åˆé¤', price: 110},
                    {name: 'æ˜“ç™¾åˆ†è‚‰è›‹åå¸', price: 65},
                    {name: 'å…ƒæ°£æ—©åˆé¤', price: 90},
                    {name: 'æ—©å®‰ç¾ä¹‹åŸ', price: 75},
                    {name: 'æ—©å®‰å±±ä¸˜', price: 80},
                    {name: 'æ–°åŒ–é˜¿ç™¼æ’éª¨å¤§ç‹', price: 85},
                    {name: 'åŠç•ç”°', price: 100},
                    {name: 'é£Ÿå…‰å®´éµæ¿ç‡’æ–™ç†', price: 150},
                    {name: 'å–„åŒ–å˜‰ç¾©æ­£ç«é›è‚‰é£¯', price: 70},
                    {name: 'è¶…æ‚…æ¶¼éºµ', price: 60},
                    {name: 'éºµå‘å…«æ–¹', price: 75}
                ],
                drink: [
                    {name: 'å¯ä¸å¯', price: 45},
                    {name: 'é¾œè¨˜', price: 35},
                    {name: 'è¿·å®¢å¤', price: 40},
                    {name: 'ç´…èŒ¶å·´å£«', price: 30},
                    {name: 'æ˜¥èŠ³è™Ÿ', price: 40},
                    {name: 'è¬æ³¢', price: 45},
                    {name: 'é’å±±', price: 50},
                    {name: 'é¶´èŒ¶æ¨“', price: 45},
                    {name: 'æ˜¥å®…', price: 40},
                    {name: 'çƒå¼„', price: 45},
                    {name: 'äº”æ¡è™Ÿ', price: 40},
                    {name: 'é›™åå…«æœ¨', price: 50},
                    {name: 'ä¸€æ²æ—¥', price: 45},
                    {name: 'å¾—æ­£', price: 35},
                    {name: 'èŒ¶æ¹¯æœƒ', price: 40},
                    {name: 'å¤§èŒ—', price: 35},
                    {name: 'å…ˆå–é“', price: 40},
                    {name: 'æ°´é›²æœµ', price: 45},
                    {name: 'è€è³´', price: 35},
                    {name: 'Tea Topç¬¬ä¸€å‘³', price: 35},
                    {name: 'é®®èŒ¶é“', price: 35},
                    {name: 'è§’é‹ª', price: 40},
                    {name: 'æ°´å··èŒ¶å¼„', price: 40},
                    {name: 'éº»å¤', price: 50},
                    {name: 'ä¸‰åˆ†æ˜¥è‰²', price: 45},
                    {name: 'æ…•æ˜¥è·äºº', price: 45},
                    {name: 'ç±³é‡Œç±³é‡Œ', price: 40},
                    {name: 'ç©†ç´', price: 45},
                    {name: 'å¾¡ç§è—', price: 40},
                    {name: 'cocoéƒ½å¯', price: 35},
                    {name: 'éŠ€å…©', price: 45},
                    {name: 'å¹•å’ŒèŒ¶å±‹', price: 50},
                    {name: 'Nanafru', price: 55},
                    {name: 'ç´…å¤ªé™½', price: 30},
                    {name: 'ç™½å··å­', price: 45},
                    {name: 'é®®è‡ªç„¶', price: 35}
                ]
            },
            other: {
                lunch: [
                    {name: 'ç‹å“ç‰›æ’ (æ°¸åº·åº—)', price: 1200},
                    {name: 'é™¶æ¿å±‹ (æ°¸åº·åº—)', price: 600},
                    {name: 'è¥¿å ¤ç‰›æ’ (æ±å€åº—)', price: 800},
                    {name: 'å¤æ…•å°¼ (ä¸­è¥¿å€åº—)', price: 900},
                    {name: 'çŸ³äºŒé‹ (å¤šåˆ†åº—)', price: 350},
                    {name: 'è—å£½å¸ (æ°¸åº·åº—)', price: 200},
                    {name: 'å£½å¸éƒ (å®‰å¹³åº—)', price: 180},
                    {name: 'ä¸¸é¾œè£½éºµ (å—ç´¡åº—)', price: 150},
                    {name: 'é˜¿æ†¨é¹¹ç²¥', price: 100},
                    {name: 'æ–‡ç« ç‰›è‚‰æ¹¯', price: 180},
                    {name: 'é˜¿æ‘ç‰›è‚‰æ¹¯', price: 150},
                    {name: 'å‘¨æ°è¦å·', price: 120},
                    {name: 'å¯Œç››è™Ÿç¢—ç²¿', price: 50},
                    {name: 'è‘‰å®¶å°å·ç±³ç²‰', price: 70},
                    {name: 'åŒè¨˜å®‰å¹³è±†èŠ±', price: 50},
                    {name: 'èœ·å°¾å®¶æ•£æ­¥ç”œé»', price: 100},
                    {name: 'çŸ®ä»”æˆè¦ä»é£¯', price: 80},
                    {name: 'é›†å“è¦ä»é£¯', price: 80},
                    {name: 'ç¦è¨˜è‚‰åœ“', price: 50},
                    {name: 'é˜¿æ˜è±¬å¿ƒ', price: 150},
                    {name: 'é˜¿é¾é¦™è…¸ç†Ÿè‚‰', price: 60},
                    {name: 'è‰è‰æ°´æœåº—', price: 120}
                ],
                drink: [
                    {name: 'èœ·å°¾å®¶å†°èŒ¶', price: 60},
                    {name: 'æ˜¥èŠ³è™Ÿ', price: 40},
                    {name: 'é’è›™é»‘è›‹å¥¶', price: 60},
                    {name: 'æœèŠ³å­å¤å‘³èŒ¶é‹ª', price: 100},
                    {name: 'å—æ³‰å†°è“å®¤', price: 40},
                    {name: 'æ¤¿ä¹‹å‘³', price: 60},
                    {name: 'ç™½å··å­ (å®‰å¹³åº—)', price: 45},
                    {name: 'ç¸½è£é»é»é ­', price: 50},
                    {name: 'ç„¡é£²', price: 55},
                    {name: 'é®®è‡ªç„¶', price: 40},
                    {name: 'ä¹…å¾¡è³ç†æƒ³', price: 45},
                    {name: 'æ³¢å“¥èŒ¶é£²', price: 35},
                    {name: 'å®£ç¦å±…', price: 50},
                    {name: 'èŒ¶ä¾†èŒ¶å»', price: 30},
                    {name: 'èŒ¶çš„é­”æ‰‹', price: 45},
                    {name: 'é­”åŠ›ç‰›ç‰›æ’é¤¨é£²æ–™', price: 50},
                    {name: 'è—å£½å¸é£²æ–™', price: 40},
                    {name: 'å£½å¸éƒé£²æ–™', price: 35},
                    {name: 'ä¸¸é¾œè£½éºµé£²æ–™', price: 30},
                    {name: 'é›™å…¨ç´…èŒ¶', price: 40},
                    {name: 'é’å±±èŒ¶è¡Œ', price: 50},
                    {name: 'è—¥å¸«ç´…èŒ¶', price: 45},
                    {name: 'ä»™è±†é¾Qå¥¶', price: 60},
                    {name: 'æ¯›è±†Qç²¿', price: 35},
                    {name: 'ç³¯å¤«ç±³ç³•æ¢…å­ç¶ ', price: 50}
                ]
            }
        };
        
        let currentArea = 'local';
        let currentRecommendation = null;
        
        // æª¢æŸ¥æ˜¯å¦ç‚ºæ›´æ–°æ—¥ï¼ˆæ¯æœˆ1è™Ÿæˆ–15è™Ÿï¼‰
        function checkUpdateDay() {
            const today = new Date();
            const day = today.getDate();
            
            if (day === 1 || day === 15) {
                document.getElementById('updateNotice').classList.add('show');
            }
        }
        
        // éš±è—æ›´æ–°æé†’
        function hideUpdateNotice() {
            document.getElementById('updateNotice').classList.remove('show');
        }
        
        // å‰µå»ºæ˜Ÿæ˜Ÿç‰¹æ•ˆ
        function createSparkles() {
            const sparklesContainer = document.getElementById('sparkles');
            for (let i = 0; i < 20; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.style.left = Math.random() * 100 + '%';
                sparkle.style.top = Math.random() * 100 + '%';
                sparkle.style.animationDelay = Math.random() * 2 + 's';
                sparklesContainer.appendChild(sparkle);
            }
        }
        
        // æ–½å±•é­”æ³•ï¼ˆæ¨è–¦ï¼‰
        function unlockSeal() {
            // éš¨æ©Ÿé¸æ“‡
            const lunch = menuData.lunch[Math.floor(Math.random() * menuData.lunch.length)];
            const drink = menuData.drink[Math.floor(Math.random() * menuData.drink.length)];
            
            currentRecommendation = {lunch, drink};
            
            // é¡¯ç¤ºçµæœ
            document.getElementById('lunchName').textContent = lunch.name;
            document.getElementById('lunchPrice').textContent = `${lunch.price}`;
            
            document.getElementById('drinkName').textContent = drink.name;
            document.getElementById('drinkPrice').textContent = `${drink.price}`;
            
            document.getElementById('totalPrice').textContent = `${lunch.price + drink.price}`;
            
            // é¡¯ç¤ºçµæœå®¹å™¨
            const resultContainer = document.getElementById('resultContainer');
            resultContainer.classList.remove('show');
            setTimeout(() => {
                resultContainer.classList.add('show');
            }, 100);
            
            // æ”¹è®Šå°å°åœ–ç¤º
            document.querySelector('.seal-icon').textContent = 'âœ¨';
            
            // éš±è—æ›´æ–°æé†’
            hideUpdateNotice();
        }
        
        // å‚™ç”¨è¤‡è£½æ–¹æ³•
        function fallbackCopy(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';
            textarea.style.opacity = '0';
            document.body.appendChild(textarea);
            textarea.select();
            try {
                document.execCommand('copy');
                alert('âœ… é­”æ³•çµæœå·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼');
            } catch (err) {
                alert('âŒ è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½');
            }
            document.body.removeChild(textarea);
        }
        
        // å‚™ç”¨è¤‡è£½æ–¹æ³•
        function fallbackCopy(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';
            textarea.style.opacity = '0';
            document.body.appendChild(textarea);
            textarea.select();
            try {
                document.execCommand('copy');
                alert('âœ… é­”æ³•çµæœå·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼');
            } catch (err) {
                alert('âŒ è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½');
            }
            document.body.removeChild(textarea);
        }
        
        // åˆå§‹åŒ–
        createSparkles();
        checkUpdateDay();
        loadFromStorage();
        generateAppIcon();
        
        // ç”Ÿæˆ App åœ–ç¤º
        function generateAppIcon() {
            try {
                const canvas = document.createElement('canvas');
                canvas.width = 180;
                canvas.height = 180;
                const ctx = canvas.getContext('2d');
                
                if (!ctx) return;
                
                // ç¹ªè£½æ¼¸å±¤èƒŒæ™¯
                const gradient = ctx.createLinearGradient(0, 0, 180, 180);
                gradient.addColorStop(0, '#667eea');
                gradient.addColorStop(1, '#764ba2');
                ctx.fillStyle = gradient;
                
                // ç¹ªè£½åœ“è§’çŸ©å½¢ï¼ˆä½¿ç”¨è·¯å¾‘ä»£æ›¿ roundRectï¼‰
                const radius = 40;
                ctx.beginPath();
                ctx.moveTo(radius, 0);
                ctx.lineTo(180 - radius, 0);
                ctx.quadraticCurveTo(180, 0, 180, radius);
                ctx.lineTo(180, 180 - radius);
                ctx.quadraticCurveTo(180, 180, 180 - radius, 180);
                ctx.lineTo(radius, 180);
                ctx.quadraticCurveTo(0, 180, 0, 180 - radius);
                ctx.lineTo(0, radius);
                ctx.quadraticCurveTo(0, 0, radius, 0);
                ctx.closePath();
                ctx.fill();
                
                // ç¹ªè£½ç™½è‰²éª°å­
                const diceSize = 70;
                const diceX = 90 - diceSize/2;
                const diceY = 55;
                
                // éª°å­é™°å½±
                ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
                ctx.shadowBlur = 10;
                ctx.shadowOffsetX = 3;
                ctx.shadowOffsetY = 3;
                
                // éª°å­ä¸»é«”ï¼ˆåœ“è§’çŸ©å½¢ï¼‰
                ctx.fillStyle = 'white';
                const diceRadius = 12;
                ctx.beginPath();
                ctx.moveTo(diceX + diceRadius, diceY);
                ctx.lineTo(diceX + diceSize - diceRadius, diceY);
                ctx.quadraticCurveTo(diceX + diceSize, diceY, diceX + diceSize, diceY + diceRadius);
                ctx.lineTo(diceX + diceSize, diceY + diceSize - diceRadius);
                ctx.quadraticCurveTo(diceX + diceSize, diceY + diceSize, diceX + diceSize - diceRadius, diceY + diceSize);
                ctx.lineTo(diceX + diceRadius, diceY + diceSize);
                ctx.quadraticCurveTo(diceX, diceY + diceSize, diceX, diceY + diceSize - diceRadius);
                ctx.lineTo(diceX, diceY + diceRadius);
                ctx.quadraticCurveTo(diceX, diceY, diceX + diceRadius, diceY);
                ctx.closePath();
                ctx.fill();
                
                // æ¸…é™¤é™°å½±
                ctx.shadowColor = 'transparent';
                ctx.shadowBlur = 0;
                ctx.shadowOffsetX = 0;
                ctx.shadowOffsetY = 0;
                
                // ç¹ªè£½éª°å­é»æ•¸ï¼ˆ5é»ï¼‰
                ctx.fillStyle = '#667eea';
                const dotRadius = 5;
                const offset = 18;
                const centerX = diceX + diceSize/2;
                const centerY = diceY + diceSize/2;
                
                // ä¸­å¿ƒé»
                ctx.beginPath();
                ctx.arc(centerX, centerY, dotRadius, 0, Math.PI * 2);
                ctx.fill();
                
                // å››å€‹è§’çš„é»
                const dots = [
                    [centerX - offset, centerY - offset],
                    [centerX + offset, centerY - offset],
                    [centerX - offset, centerY + offset],
                    [centerX + offset, centerY + offset]
                ];
                
                dots.forEach(([x, y]) => {
                    ctx.beginPath();
                    ctx.arc(x, y, dotRadius, 0, Math.PI * 2);
                    ctx.fill();
                });
                
                // ç¹ªè£½æ–‡å­—
                ctx.font = 'bold 20px Arial, "Microsoft JhengHei"';
                ctx.fillStyle = 'white';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('é­”æ³•é¤é»', 90, 150);
                
                // è¨­ç½®ç‚º apple-touch-icon
                const iconLink = document.getElementById('appleIcon');
                if (iconLink) {
                    iconLink.href = canvas.toDataURL('image/png');
                }
            } catch (error) {
                console.error('ç”Ÿæˆåœ–ç¤ºå¤±æ•—:', error);
            }
        }
        
        // Modal ç®¡ç†
        function openManageModal() {
            const modal = document.getElementById('manageModal');
            if (modal) {
                modal.classList.add('show');
                updateStoreList();
            }
        }
        
        function closeManageModal() {
            const modal = document.getElementById('manageModal');
            if (modal) {
                modal.classList.remove('show');
            }
        }
        
        function switchTab(tab) {
            // åˆ‡æ›æŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            // åˆ‡æ›å…§å®¹
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            const tabContent = document.getElementById(tab + 'Tab');
            if (tabContent) {
                tabContent.classList.add('active');
            }
            
            if (tab === 'list') {
                updateStoreList();
            }
        }
        
        // å¾ storage è¼‰å…¥è³‡æ–™
        function loadFromStorage() {
            try {
                const savedLocal = localStorage.getItem('localStores');
                const savedOther = localStorage.getItem('otherStores');
                
                if (savedLocal) {
                    const data = JSON.parse(savedLocal);
                    if (data.lunch) menuData.local.lunch = data.lunch;
                    if (data.drink) menuData.local.drink = data.drink;
                }
                if (savedOther) {
                    const data = JSON.parse(savedOther);
                    if (data.lunch) menuData.other.lunch = data.lunch;
                    if (data.drink) menuData.other.drink = data.drink;
                }
            } catch (e) {
                console.log('è¼‰å…¥è³‡æ–™å¤±æ•—');
            }
        }
        
        // å„²å­˜åˆ° storage
        function saveToStorage() {
            try {
                localStorage.setItem('localStores', JSON.stringify({
                    lunch: menuData.local.lunch,
                    drink: menuData.local.drink
                }));
                localStorage.setItem('otherStores', JSON.stringify({
                    lunch: menuData.other.lunch,
                    drink: menuData.other.drink
                }));
            } catch (e) {
                console.log('å„²å­˜è³‡æ–™å¤±æ•—');
            }
        }
        
        // æ–°å¢åº—å®¶
        function addStore() {
            const type = document.getElementById('itemType').value;
            const name = document.getElementById('storeName').value.trim();
            const price = parseInt(document.getElementById('storePrice').value);
            
            if (!name || !price || price <= 0) {
                alert('âŒ è«‹å¡«å¯«å®Œæ•´è³‡æ–™ï¼');
                return;
            }
            
            // æª¢æŸ¥æ˜¯å¦é‡è¤‡
            const list = type === 'lunch' ? menuData.lunch : menuData.drink;
            if (list.some(item => item.name === name)) {
                alert('âš ï¸ æ­¤åº—å®¶å·²å­˜åœ¨ï¼');
                return;
            }
            
            // æ–°å¢åº—å®¶
            list.push({name, price});
            list.sort((a, b) => a.name.localeCompare(b.name, 'zh-TW'));
            
            saveToStorage();
            
            // æ¸…ç©ºè¡¨å–®
            document.getElementById('storeName').value = '';
            document.getElementById('storePrice').value = '';
            
            alert(`âœ… å·²åŠ å…¥ ${name} åˆ°é­”æ³•åå–®ï¼`);
            updateStoreList();
        }
        
        // åˆªé™¤åº—å®¶
        function deleteStore(type, index) {
            if (!confirm('ç¢ºå®šè¦å¾é­”æ³•åå–®ä¸­ç§»é™¤æ­¤åº—å®¶å—ï¼Ÿ')) {
                return;
            }
            
            if (type === 'lunch') {
                menuData.lunch.splice(index, 1);
            } else {
                menuData.drink.splice(index, 1);
            }
            
            saveToStorage();
            updateStoreList();
            alert('âœ… å·²å¾é­”æ³•åå–®ä¸­ç§»é™¤ï¼');
        }
        
        // æ›´æ–°åº—å®¶åˆ—è¡¨é¡¯ç¤º
        function updateStoreList() {
            // åˆé¤åˆ—è¡¨
            const lunchList = document.getElementById('lunchList');
            lunchList.innerHTML = '';
            menuData.lunch.forEach((store, index) => {
                const div = document.createElement('div');
                div.className = 'store-item';
                div.innerHTML = `
                    <div class="store-info">
                        <div class="store-name">${store.name}</div>
                        <div class="store-price">${store.price}</div>
                    </div>
                    <button class="delete-btn" onclick="deleteStore('lunch', ${index})">åˆªé™¤</button>
                `;
                lunchList.appendChild(div);
            });
            document.getElementById('lunchCount').textContent = menuData.lunch.length;
            
            // é£²æ–™åˆ—è¡¨
            const drinkList = document.getElementById('drinkList');
            drinkList.innerHTML = '';
            menuData.drink.forEach((store, index) => {
                const div = document.createElement('div');
                div.className = 'store-item';
                div.innerHTML = `
                    <div class="store-info">
                        <div class="store-name">${store.name}</div>
                        <div class="store-price">${store.price}</div>
                    </div>
                    <button class="delete-btn" onclick="deleteStore('drink', ${index})">åˆªé™¤</button>
                `;
                drinkList.appendChild(div);
            });
            document.getElementById('drinkCount').textContent = menuData.drink.length;
        }
        
        // é»æ“Š Modal å¤–éƒ¨é—œé–‰
        const manageModal = document.getElementById('manageModal');
        if (manageModal) {
            manageModal.addEventListener('click', function(e) {
                if (e.target === this) {
                    closeManageModal();
                }
            });
        }
    </script>
</body>
</html>